<div class="dashboard-container">
  
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="header-title">
        <h1>Sistema de Chamados</h1>
        <p class="welcome-message" *ngIf="userData">
          Bem-vindo, <strong>{{ userData.firstName || userData.login }}</strong>
        </p>
      </div>
      
      <div class="header-actions">
        <!-- Status SignalR -->
        <div class="signalr-status">
          <div class="status-indicator" [class.connected]="isSignalRConnected" [class.disconnected]="!isSignalRConnected">
            <span class="status-dot"></span>
            <span class="status-text">
              {{ isSignalRConnected ? 'Tempo Real: Ativo' : 'Tempo Real: Inativo' }}
            </span>
          </div>
          <button 
            *ngIf="!isSignalRConnected" 
            class="btn-reconnect" 
            (click)="reconnectSignalR()"
            title="Reconectar tempo real"
          >
            üîÑ
          </button>
        </div>

        <!-- Bot√µes de a√ß√£o -->
        <button class="btn-secondary" (click)="refreshChamados()" [disabled]="isLoading">
          <span class="btn-icon">üîÑ</span>
          Atualizar
        </button>
        
        <button class="btn-danger" (click)="logout()">
          <span class="btn-icon">üö™</span>
          Sair
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="dashboard-main">
    
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Carregando chamados...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="errorMessage && !isLoading" class="error-container">
      <div class="error-card">
        <span class="error-icon">‚ö†Ô∏è</span>
        <p>{{ errorMessage }}</p>
        <button class="btn-primary" (click)="refreshChamados()">
          Tentar Novamente
        </button>
      </div>
    </div>

    <!-- Filtros -->
    <div class="filters-container" *ngIf="!isLoading && !errorMessage">
      <input
        type="text"
        placeholder="Filtrar por t√≠tulo"
        [(ngModel)]="filtroTitulo"
        (ngModelChange)="onFiltroChange()"
        class="filter-input"
      />
      <input
        type="text"
        placeholder="Filtrar por descri√ß√£o"
        [(ngModel)]="filtroDescricao"
        (ngModelChange)="onFiltroChange()"
        class="filter-input"
      />
    </div>

    <!-- Chamados Table -->
    <div *ngIf="!isLoading && !errorMessage" class="table-container">
      
      <!-- Table Header Info -->
      <div class="table-header-info">
        <h2>Lista de Chamados</h2>
        <div class="table-info">
          <span class="info-badge">
            {{ totalChamados }} chamados encontrados
          </span>
          <span class="realtime-badge" *ngIf="isSignalRConnected">
            ‚ö° Atualiza√ß√µes em tempo real
          </span>
        </div>
      </div>

      <!-- Responsive Table -->
      <div class="table-responsive">
        <table class="chamados-table">
          <thead>
            <tr>
              <th>#ID</th>
              <th>T√≠tulo</th>
              <th>Descri√ß√£o</th>
              <th>Status</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <tr 
              *ngFor="let chamado of chamadosFiltrados; trackBy: trackByChamado" 
              class="table-row"
            >
              <td class="col-id">
                <span class="id-badge">{{ chamado.id }}</span>
              </td>
              
              <td class="col-titulo">
                <div class="titulo-content">
                  <span class="titulo-text">{{ chamado.titulo }}</span>
                </div>
              </td>
              
              <td class="col-descricao">
                <div class="descricao-content">
                  <p class="descricao-text" [title]="chamado.descricao">
                    {{ chamado.descricao }}
                  </p>
                </div>
              </td>
              
              <td class="col-status">
                <span 
                  class="status-badge" 
                  [ngClass]="getStatusClass(chamado.status)"
                >
                  {{ getStatusText(chamado.status) }}
                </span>
              </td>
              
              <td class="col-data">
                <time class="date-text" [dateTime]="chamado.dataCadastro">
                  {{ formatDate(chamado.dataCadastro) }}
                </time>
              </td>
            </tr>
            
            <!-- Empty State -->
            <tr *ngIf="chamadosFiltrados.length === 0" class="empty-row">
              <td colspan="5" class="empty-cell">
                <div class="empty-state">
                  <span class="empty-icon">üìã</span>
                  <p class="empty-title">Nenhum chamado encontrado</p>
                  <p class="empty-subtitle">Os chamados aparecer√£o aqui quando dispon√≠veis</p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagina√ß√£o -->
      <div class="pagination-container" *ngIf="totalChamados > maximoPorPagina">
        <button (click)="onPageChange(paginaAtual - 1)" [disabled]="paginaAtual === 1">Anterior</button>
        <span>P√°gina {{ paginaAtual }} de {{ totalPaginas() }}</span>
        <button (click)="onPageChange(paginaAtual + 1)" [disabled]="paginaAtual === totalPaginas()">Pr√≥ximo</button>
      </div>

    </div>

  </main>

  <!-- Footer -->
  <footer class="dashboard-footer">
    <p>&copy; 2024 Desafio Front-end Casasoft - Sistema desenvolvido com Angular</p>
  </footer>

</div>
